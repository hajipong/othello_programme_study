# 2-4. クリックで石を置こう　Unitテスト

もう一つロジックに入る前にやらないといけないことが。みんな大好き単体テストです！

単体テストに馴染みが無い方も多いと思います。プログラムをメソッド単位で想定通りの挙動をしているかをテスト用のプログラムによって保証するものになります。
例えばこんなメソッドがあるとします。

```
function hoge(a, b) {
  return a + b;
}
```
テストするまでもなく単純ですね。これをUnitテストのツールを使ってこんな感じに書きます
```
expect(hoge(1, 2)).toBe(3);
expect(hoge(0, 4)).toBe(4);
expect(hoge(-10, 52)).toBe(42);
```
そしてUnitテストを実行すると、これらのうち1個でも満たしてないものが出たらそれを検知できるようになるのです。

## JavaScriptにはJestというツールがある

私もこの記事を書くために初めて使いますが、メジャーな言語であれば必ずUnitテストのツールはあります。
使い方も大きくは変わらないでしょう。

インストール方法などは環境の違いなどが発生してしまうのでここでは詳しいインストールの仕方はしませんので、自分のところで動かせるように入れてみましょう。前提としてNodeJSが動かせるのが条件です。

このリポジトリではテストに必要になるpackage.json、package-lock.json、.babelrcのファイルをコミットしてはいます。
最終的に` npx jest`コマンドを叩いて3件のテストが合格した結果が出ればOKです。

## Untiテストの書き方

`board_view.text.js`にテストコードを書きました。ここには合計3つテストがあります。

`describe`で囲んでる部分は「何の機能をテストします」な感じの括りにしてます。1個目だと`parse_cell_point`のメソッドをテストするという意思表示です。書いてる文字列はあくまでラベルなので何を書いても良いのですが、こうやってまとめた単位を書くとわかりやすいです。

`test`で囲んでる部分は1件のテストとして実行される範囲です。ラベルは同じように自由に書けます。今回は引数に与える数字をタイトルとして書きました。

`expect`は検証部分です。ここの中に記述する処理の結果、つまり戻り値を持って、続く次のメソッドに託します。

`toStrictEqual`少し例が飛んじゃってますが、expectの結果をどう見るかを決める部分の内、オブジェクトの型と値どちらも一致してることを判断するメソッドになります。1件目では連想配列を比較してますね。

最初に試すなら上に書いた`toBe(3)`がわかりやすいでしょう。これは値を比較する物です。

文法的なものはこんな感じで、「どんな入力値を入れたらどういう出力値になるべき」を考えて書くと割と簡単に書けるようになります。

少し複雑な事もできて、3件目だと`toThrow`があります。`expect`を実行した結果例外が発生することを意味します。ここだけ少し注意ですが、expectの中に`() =>`という記述があります。今はここには触れませんが違いがあることだけ。

次回こそはロジックに入ります！
- - -
前回とのコード差分

https://github.com/hajipong/othello_programme_study/compare/step2_3...step2_4
- - -

[＜前](https://github.com/hajipong/othello_programme_study/tree/step2_3)　
[次＞](https://github.com/hajipong/othello_programme_study/tree/step3_1)
